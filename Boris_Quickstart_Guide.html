<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title>1&nbsp;Boris Quickstart Guide</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="racket.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Boris The (Web) Spider</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Boris Quickstart Guide</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Boris_API.html" class="tocviewlink" data-pltdoc="x">Boris API</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Boris_Internals_and_Extension.html" class="tocviewlink" data-pltdoc="x">Boris Internals and Extension</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Boris Quickstart Guide</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">1.1&nbsp;</td><td><a href="#%28part._.Know_.Your_.Electric_.Bass_.Guitarists%29" class="tocviewlink" data-pltdoc="x">Know Your Electric Bass Guitarists</a></td></tr><tr><td align="right">1.2&nbsp;</td><td><a href="#%28part._.Improved_.Hacker_.News_.Search%29" class="tocviewlink" data-pltdoc="x">Improved Hacker News Search</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.Know_.Your_.Electric_.Bass_.Guitarists%29" class="tocsubseclink" data-pltdoc="x">Know Your Electric Bass Guitarists</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._.Improved_.Hacker_.News_.Search%29" class="tocsubseclink" data-pltdoc="x">Improved Hacker News Search</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">5.90.0.9</span></div><div class="navsettop"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="backward to &quot;Boris The (Web) Spider&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Boris The (Web) Spider&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Boris_API.html" title="forward to &quot;2 Boris API&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>1<tt>&nbsp;</tt><a name="(part._.Boris_.Quickstart_.Guide)"></a>Boris Quickstart Guide</h3><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Evan Donahue</p></span></div><p>This section will take you through a few example Boris programs to give you a feel for how Boris works. The completed programs can be found in the tests/boris collection.</p><h4>1.1<tt>&nbsp;</tt><a name="(part._.Know_.Your_.Electric_.Bass_.Guitarists)"></a>Know Your Electric Bass Guitarists</h4><p>If you are still wondering, "Why &rsquo;Boris?&rsquo;" then prepare to be educated. This first application will pull a list of bass guitarists from wikipedia, visit each of their pages, extract their nicknames, and then quiz you on the artist in question. Let&rsquo;s get ready to rock!</p><p>First, we need a web.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">require</span><span class="hspace">&nbsp;</span><span class="RktSym">boris</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Passing the web to spider should produce a list of tasty tasty flies.</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">spider</span><span class="hspace">&nbsp;</span><span class="RktSym">web1</span><span class="RktPn">)</span></p></blockquote><p><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">)</span></p><p>Hmm... no flies. This reminds me of an ancient spider proverb: "You catch more flies with a web than with honey OR vinegar." We need to build a web!</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktVal">"No flies yet..."</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">spider</span><span class="hspace">&nbsp;</span><span class="RktSym">web2</span><span class="RktPn">)</span></td></tr></table></blockquote><p><table cellspacing="0" class="RktBlk"><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">"No flies yet..."</span></td></tr><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">)</span></td></tr></table></p><p>web2 is a tree with no children that accepts a document, ignores it, and prints "No flies yet..." The "show" form is useful for development and debugging, and rather than printing a bare string, we can have it print the result of one of Boris&rsquo; selector forms, which return data about the fetched page.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">spider</span><span class="hspace">&nbsp;</span><span class="RktSym">web3</span><span class="RktPn">)</span></td></tr></table></blockquote><p><table cellspacing="0" class="RktBlk"><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">""</span></td></tr><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">)</span></td></tr></table></p><p>The body form returns the full text of the fetched document. In this case, the blank document is simply "". In order to get started with the crawl, we need to nest the show tree within a navigation tree:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web4</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"http://en.wikipedia.org/wiki/John_Entwistle"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">web3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><table cellspacing="0" class="RktBlk"><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">"&lt;!DOCTYPE html&gt;&lt;..."</span></td></tr><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">)</span></td></tr></table></p><p>The go form accepts a list of urls and, for each url, fetches the corresponding document and passes that document to each of its sub-webs. Hence, we gain the ability to express conditionals (an empty list prunes that branch of the crawl) and iteration (a full list repeats the sub-webs for each document). Moreover, because each web is just a simple tree of Racket lists, we can easily modify, compose, and reuse tree segments to build more complex crawls. Now let&rsquo;s extract some flies. A quick perusal of the markup reveals that the name and nickname fields are both contained within &amp;lt;td class=&rsquo;nickname&rsquo;&amp;gt; elements.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web5</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"http://en.wikipedia.org/wiki/John_Entwistle"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"//td[@class='nickname']/text()"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><table cellspacing="0" class="RktBlk"><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">"John Alec Entwistle"</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">"The Ox, Thunderfingers, The Quiet One, Big Johnny Twinkle"</span><span class="RktRes">)</span></td></tr><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">)</span></td></tr></table></p><p>Finally, some flies. The first item is the basist&rsquo;s name, the second is the nickname(s). To get the flies out of the crawl (show only prints to the console), we need to use an extraction form.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web6</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"http://en.wikipedia.org/wiki/John_Entwistle"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extract</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"//td[@class='nickname']/text()"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><table cellspacing="0" class="RktBlk"><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">(</span><span class="RktRes">"John Alec Entwistle"</span></td></tr><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">"The Ox, Thunderfingers, The Quiet One, Big Johnny Twinkle"</span><span class="RktRes">)</span><span class="RktRes">)</span></td></tr></table></p><p>This crawl will supply our application with one datum. If this spider is going to make a living, we are going to have to cast a wider web.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">require</span><span class="hspace">&nbsp;</span><span class="RktSym">boris</span><span class="hspace">&nbsp;</span><span class="RktSym">persistent</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web7</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"http://en.wikipedia.org/wiki/List_of_bass_guitarists"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"//div[@id='mw-content-text']/ul[position()&gt;1]/li/a[1]/@href/text()"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extract</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"//td[@class='nickname']/text()"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">flies</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">spider/generator</span><span class="hspace">&nbsp;</span><span class="RktSym">web7</span><span class="hspace">&nbsp;</span><span class="RktPn">#:cache</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-fs-dict</span><span class="hspace">&nbsp;</span><span class="RktVal">"/tmp/bassists"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">flies</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">flies</span><span class="RktPn">)</span></td></tr></table></blockquote><p><table cellspacing="0" class="RktBlk"><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">"Willy Abers"</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">"Breakdance Willy"</span><span class="RktRes">)</span></td></tr><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">"Bryan Guy Adams"</span><span class="RktRes">)</span></td></tr></table></p><p>This code fetches Wikipedia&rsquo;s list of bass guitarists, and then for each guitarist runs the previous extraction. So that we can use the results as we find them rather than waiting for the whole crawl to complete, we use the spider/generator form. We also use a persistent dict as the spider&rsquo;s cache so that after the first run we can play the game in the future without needing to make network requests. Now we can build our application:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">for</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">in-producer</span><span class="hspace">&nbsp;</span><span class="RktSym">flies</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">void</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">length</span><span class="hspace">&nbsp;</span><span class="RktSym">fly</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">format</span><span class="hspace">&nbsp;</span><span class="RktVal">"To which bassist does the moniker \"~a\" belong?\n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">second</span><span class="hspace">&nbsp;</span><span class="RktSym">fly</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-ci=?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">read-line</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktSym">fly</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktVal">"Correct!\n"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">format</span><span class="hspace">&nbsp;</span><span class="RktVal">"Wrong: \"~a\"\n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktSym">fly</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><table cellspacing="0" class="RktBlk"><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">To</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">which</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">bassist</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">does</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">the</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">moniker</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">"Breakdance Willy"</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">belong?</span></td></tr><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes"><span class="hspace">&nbsp;&nbsp;&nbsp;</span></span><span class="RktRes">&gt;</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">willy</span><span class="RktRes"><span class="hspace">&nbsp;</span></span><span class="RktRes">abers</span></td></tr><tr><td><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes"><span class="hspace">&nbsp;&nbsp;&nbsp;</span></span><span class="RktRes">Correct!</span></td></tr></table></p><h4>1.2<tt>&nbsp;</tt><a name="(part._.Improved_.Hacker_.News_.Search)"></a>Improved Hacker News Search</h4><p>Not every site on the web even has a search feature, let alone one that does exactly what you want. Hacker News search, for example, can&rsquo;t show you pages where the click-through article matches your search term. This application will scan the first few pages of hacker news, click through each link, and print the title and url of the clicked article if the body of the landing page matches a user-provided regex.</p><p>To start with, we can make a web that grabs the first HN article, clicks through, and checks the resulting html with a regex. It is generally good practice to start with a persistent cache in place so that you can develop your crawler without repeatedly hitting the network.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">require</span><span class="hspace">&nbsp;</span><span class="RktSym">boris</span><span class="hspace">&nbsp;</span><span class="RktSym">persistent</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">only-in</span><span class="hspace">&nbsp;</span><span class="RktSym">net/url</span><span class="hspace">&nbsp;</span><span class="RktSym">url-&gt;string</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"https://news.ycombinator.com/"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"(//td[@class='title']/a/@href/text())[1]"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extract</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">regexp-match</span><span class="hspace">&nbsp;</span><span class="RktVal">#rx"."</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">html</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"An interesting article has been found!"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">spider</span><span class="hspace">&nbsp;</span><span class="RktSym">web1</span><span class="hspace">&nbsp;</span><span class="RktPn">#:cache</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-fs-dict</span><span class="hspace">&nbsp;</span><span class="RktVal">"/tmp/hn-search"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">"An interesting article has been found!"</span></p><p>An interesting article has been found. Wonderful. Since we have no title or url, we&rsquo;ll have to take Boris&rsquo; word for it, and spiders are not known to be particularly refined critics of prose style. This code so far grabs the first link from Hacker News and, if that article contains any letter&ndash;any letter at all&ndash;Boris reports it as "interesting." Let&rsquo;s grab the link title and combine it with the url later after we check the page.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web2</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"https://news.ycombinator.com/"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">link</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"(//td[@class='title']/a)[1]"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"/a/@href/text()"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">link</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extract</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">regexp-match</span><span class="hspace">&nbsp;</span><span class="RktVal">#rx"."</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">html</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">format</span><span class="hspace">&nbsp;</span><span class="RktVal">"~a: ~a\n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"/a/text()"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">link</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">url</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">"Newly Declassified Documents Show How the Surveillance State was Born: http://www.newrepublic.com/article/114795/declassified-legal-opinions-show-how-surveillance-state-was-born"</span><span class="RktRes">)</span></p><p>Now that we have it working for one page, we can widen the search to the whole list. We should also probably switch from spider to spider/generator so we can see the results as they come in.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">search-page</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">for/web</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">link</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"//td[@class='title']/a"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"/a/@href/text()"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">link</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extract</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">regexp-match</span><span class="hspace">&nbsp;</span><span class="RktVal">#rx"."</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">format</span><span class="hspace">&nbsp;</span><span class="RktVal">"~a: ~a"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"/a/text()"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">link</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">url-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">url</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web3</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"https://news.ycombinator.com/"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">search-page</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">flies</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">spider/generator</span><span class="hspace">&nbsp;</span><span class="RktSym">web3</span><span class="hspace">&nbsp;</span><span class="RktPn">#:cache</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-fs-dict</span><span class="hspace">&nbsp;</span><span class="RktVal">"/tmp/hn-search"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">for</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">in-producer</span><span class="hspace">&nbsp;</span><span class="RktSym">flies</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">void</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktSym">fly</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newline</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Now that we have the web that searches a whole page nicely abstracted out, we can follow the pagination links and apply this search to as many pages as we want. Because HN is optimized to serve recent pages, we&rsquo;ll limit it to the first 2.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">web4</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"https://news.ycombinator.com/"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let/web</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">pages-crawled</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">label</span><span class="hspace">&nbsp;</span><span class="RktSym">hn-page</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">search-page</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pages-crawled</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"//td[@class='title']/a[text() = 'More']/@href/text()"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let/web</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">pages-crawled</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pages-crawled</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">recur</span><span class="hspace">&nbsp;</span><span class="RktSym">hn-page</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>With this in hand, we can package it up into a function that searches over any regexp.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">search-hn/page</span><span class="hspace">&nbsp;</span><span class="RktSym">rx</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">for/web</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">link</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"//td[@class='title']/a"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"/a/@href/text()"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">link</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extract</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">regexp-match</span><span class="hspace">&nbsp;</span><span class="RktSym">rx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">format</span><span class="hspace">&nbsp;</span><span class="RktVal">"~a: ~a"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"/a/text()"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">link</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">url-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">url</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">search-hn</span><span class="hspace">&nbsp;</span><span class="RktSym">rx</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"https://news.ycombinator.com/"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let/web</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">pages-crawled</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">label</span><span class="hspace">&nbsp;</span><span class="RktSym">hn-page</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">search-hn/page</span><span class="hspace">&nbsp;</span><span class="RktSym">rx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pages-crawled</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">xpath</span><span class="hspace">&nbsp;</span><span class="RktVal">"//td[@class='title']/a[text() = 'More']/@href/text()"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let/web</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">pages-crawled</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pages-crawled</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">recur</span><span class="hspace">&nbsp;</span><span class="RktSym">hn-page</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Now at last we can search for news of real interest.</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">search-hn</span><span class="hspace">&nbsp;</span><span class="RktVal">#rx"boris"</span><span class="RktPn">)</span></p></blockquote><p><span class="RktRes"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktRes">'</span><span class="RktRes">(</span><span class="RktRes">)</span></p><div class="navsetbottom"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="backward to &quot;Boris The (Web) Spider&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Boris The (Web) Spider&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Boris_API.html" title="forward to &quot;2 Boris API&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>