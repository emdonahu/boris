<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title>3&nbsp;Boris Internals and Extension</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="racket.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Boris The (Web) Spider</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Boris_Quickstart_Guide.html" class="tocviewlink" data-pltdoc="x">Boris Quickstart Guide</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Boris_API.html" class="tocviewlink" data-pltdoc="x">Boris API</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Boris Internals and Extension</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>3&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Boris Internals and Extension</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.1&nbsp;</td><td><a href="#%28part._.Extending_.Webs%29" class="tocviewlink" data-pltdoc="x">Extending Webs</a></td></tr><tr><td align="right">3.2&nbsp;</td><td><a href="#%28part._.Extending_.Spiders%29" class="tocviewlink" data-pltdoc="x">Extending Spiders</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.Extending_.Webs%29" class="tocsubseclink" data-pltdoc="x">Extending Webs</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._.Extending_.Spiders%29" class="tocsubseclink" data-pltdoc="x">Extending Spiders</a></td></tr><tr><td><a href="#%28def._%28%28lib._boris%2Finterpreter%2Fservices..rkt%29._services~3c~25~3e%29%29" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: boris/interpreter/services"><span class="RktSym">services&lt;%&gt;</span></span></a></td></tr><tr><td><a href="#%28meth._%28%28%28lib._boris%2Finterpreter%2Fservices..rkt%29._services~3c~25~3e%29._request%29%29" class="tocsubnonseclink" data-pltdoc="x">request</a></td></tr><tr><td><a href="#%28meth._%28%28%28lib._boris%2Finterpreter%2Fservices..rkt%29._services~3c~25~3e%29._extract%29%29" class="tocsubnonseclink" data-pltdoc="x">extract</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">5.90.0.9</span></div><div class="navsettop"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Boris_API.html" title="backward to &quot;2 Boris API&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Boris The (Web) Spider&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h3>3<tt>&nbsp;</tt><a name="(part._.Boris_.Internals_and_.Extension)"></a>Boris Internals and Extension</h3><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Evan Donahue</p></span></div><p>Given the highly unpredictable nature of data out on the web, Boris was built to be as flexible and extensible as possible.</p><h4>3.1<tt>&nbsp;</tt><a name="(part._.Extending_.Webs)"></a>Extending Webs</h4><p>A web is simply a tree of functions composed of Racket lists. Because webs are just lists, adding new web-spinning forms or modifying existing webs is simple. For example, these three programs have roughly the same effect:</p><p><div class="SIntrapara">Using normal Boris forms:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"http://www.wikipedia.org"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Extending the web forms:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"http://www.wikipedia.org"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state</span><span class="hspace">&nbsp;</span><span class="RktSym">services</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">browser-body</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">crawl-state-browser</span><span class="hspace">&nbsp;</span><span class="RktSym">state</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">]</div></p><p><div class="SIntrapara">Modifying the web at run-time:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-web</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">go</span><span class="hspace">&nbsp;</span><span class="RktVal">"http://www.wikipedia.org"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">state</span><span class="hspace">&nbsp;</span><span class="RktSym">services</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">browser-body</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">crawl-state-browser</span><span class="hspace">&nbsp;</span><span class="RktSym">state</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4>3.2<tt>&nbsp;</tt><a name="(part._.Extending_.Spiders)"></a><a name="(mod-path._boris/interpreter/services)"></a>Extending Spiders</h4><p><table cellspacing="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/apocalypsemystic/src/racket/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._boris%2Finterpreter%2Fservices%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">boris/interpreter/services</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <span class="stt">boris</span></span></td></tr></table></p><p>The spider is a relatively simple function that threads the output states of web forms into the inputs of sub forms. As such, it would not be difficult to simply write a new spider function that executed breadth-first instead of the default spider&rsquo;s more depth-first orientation. However, much of the spider&rsquo;s functionality is provided by an extensible services object that it passes to every web form. Current Boris forms rely only on request and extract methods, but custom forms could rely on corresponding custom extensions to the external services object.</p><p><div class="SIntrapara"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>interface</p></div></div><p class="RForeground"><a name="(def._((lib._boris/interpreter/services..rkt)._services~3c~25~3e))"></a><span title="Provided from: boris/interpreter/services"><span class="RktSym">services&lt;%&gt;</span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///home/apocalypsemystic/src/racket/racket/doc/reference/objectutils.html#%28def._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._interface~3f%29%29" class="RktValLink" data-pltdoc="x">interface?</a></span></p></blockquote></td></tr></table></div><div class="SIntrapara"><blockquote class="leftindent"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>method</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/apocalypsemystic/src/racket/racket/doc/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktVar">a-services</span><span class="hspace">&nbsp;</span><a name="(meth._(((lib._boris/interpreter/services..rkt)._services~3c~25~3e)._request))"></a>request</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">state</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">browser-request</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">any/c</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">state</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">crawl-state?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">browser-request</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">request?</span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>method</p></div></div><p class="RForeground"><span class="RktPn">(</span><span class="RktSym"><a href="file:///home/apocalypsemystic/src/racket/racket/doc/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktVar">a-services</span><span class="hspace">&nbsp;</span><a name="(meth._(((lib._boris/interpreter/services..rkt)._services~3c~25~3e)._extract))"></a>extract<span class="hspace">&nbsp;</span><span class="RktVar">datum</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">void?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr></table></blockquote></div><div class="SIntrapara"></div></p></blockquote></div></p><div class="navsetbottom"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Boris_API.html" title="backward to &quot;2 Boris API&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Boris The (Web) Spider&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>